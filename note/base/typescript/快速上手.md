# 快速上手

## TypeScript的作用

JavaScript诞生于Netscape，运行于浏览器端，最初只是希望其能够在浏览器中处理一些简单的用户交互，如表单验证等操作，而不必每次都交与服务端验证。因此它设计的足够简单：松散的类型定义、轻量的继承体系。

与Java、C++等强类型语言不同的是，JavaScript是一门弱类型的语言，或者被称为松散类型、动态类型。这样做的好处是显而易见的，比如当类型不匹配时，它会在不告诉你的情况下自动进行类型转换，这带来的是运行速度的提升，同时使得其显得简单、容易上手。但这也并非没有缺点，由于JavaScript是解释执行的，根本不具有编译功能，缺少运行前的类型检查，只能在运行时检查并找到类型错误，这导致了更多的bug。当然，实际上无论是动态类型语言还是静态类型语言都各有优缺点，但JavaScript缺少的编译时的类型检查的确导致了很多bug的产生。

为了弥补类型上的缺点，TypeScript诞生了，由Microsoft开发，它在JavaScript的基础上，添加了静态类型定义和类型检查器，能够在执行前进行静态类型检查。

### 为什么选择TypeScript

在大型项目中，TypeScript的价值尤为明显：

**类型安全**
- 编译时捕获类型错误，避免运行时崩溃
- 提供智能代码提示，提升开发效率
- 重构更安全，IDE可以准确追踪类型引用

**可维护性**
- 类型即文档，代码即注释
- 团队协作更顺畅，接口定义清晰
- 降低代码理解成本，新成员快速上手

**工程化**
- 与现代构建工具深度集成（Webpack、Vite等）
- 支持渐进式引入，可以逐步迁移现有项目
- 丰富的生态，主流框架都有完善的类型支持

## TypeScript的组成部分

TypeScript由多个核心部分组成，每个部分都有其特定的作用：

### 类型系统

类型系统是TypeScript的核心，提供了丰富的类型定义和检查能力：

- 基础类型：string、number、boolean、null、undefined、symbol、bigint
- 对象类型：interface、type、class、enum
- 高级类型：泛型、联合类型、交叉类型、条件类型、映射类型
- 类型推断：自动推导变量和函数返回值的类型
- 类型守卫：运行时类型检查的编译时保障

类型系统在"类型系统"、"泛型"、"类型操作"等章节有详细说明。

### 编译配置文件

tsconfig.json是TypeScript项目的配置文件，主要功能包括：

- 指定编译文件范围（files、include、exclude）
- 配置编译选项（compilerOptions）
- 指定输出目录和模块系统
- 配置类型检查严格程度
- 配置JSX处理方式
- 配置路径映射等

详细配置说明见"tsconfig配置文件"章节。

### 声明文件

声明文件（.d.ts）用于为JavaScript代码提供类型信息：

- 为第三方库提供类型定义
- 为现有JavaScript项目添加类型支持
- 扩展全局类型定义
- 模块声明和命名空间声明

声明文件的编写和使用在"声明文件"章节有详细说明。

### 模块系统

TypeScript支持多种模块系统：

- ES Modules（推荐）：import/export语法
- CommonJS：require/module.exports
- AMD、UMD等历史模块系统

模块系统的详细说明见"模块系统"章节。

### 编译器（tsc）

TypeScript编译器负责将TypeScript代码转换为JavaScript：

- 类型检查和错误报告
- 代码转换和降级（target配置）
- Source Map生成，支持源码调试
- 增量编译，提升编译速度

编译器命令行工具的使用见"tsc命令行工具"章节。

### 装饰器

装饰器提供了一种声明式的方式来修改类、方法、属性等：

- 类装饰器
- 方法装饰器
- 属性装饰器
- 参数装饰器

装饰器的使用见"装饰器"章节。

## TypeScript与JavaScript生态集成

TypeScript设计之初就考虑了与现有JavaScript生态的无缝集成，这使得引入TypeScript的成本大大降低。

### 第三方模块的类型支持

#### 自带类型定义的模块

现代JavaScript库越来越多地自带TypeScript类型定义：

```typescript
// 直接安装使用，无需额外配置
import { useState } from 'react'
import { createRouter } from 'vue-router'
```

这些库在package.json中包含types或typings字段，TypeScript会自动识别。

#### @types类型声明包

对于不自带类型定义的库，DefinitelyTyped项目提供了社区维护的类型定义：

```bash
# 安装类型定义包
npm install --save-dev @types/lodash
npm install --save-dev @types/node
npm install --save-dev @types/jest
```

类型定义包的命名规则是`@types/包名`，安装后TypeScript会自动识别。

#### 查找类型声明的方式

1. **官方文档**：查看库的文档是否说明TypeScript支持
2. **TypeSearch**：访问 https://www.typescriptlang.org/dt/search 搜索
3. **npm搜索**：搜索`@types/包名`
4. **IDE提示**：VSCode会提示安装可用的类型包

### 常用框架的TypeScript集成

#### React

React从16.8版本开始完全支持TypeScript：

```bash
# 创建TypeScript版本的React应用
npx create-react-app my-app --template typescript

# 或使用Vite
npm create vite@latest my-app -- --template react-ts
```

```typescript
import { useState, FC } from 'react'

interface Props {
  title: string
  count?: number
}

const Counter: FC<Props> = ({ title, count = 0 }) => {
  const [value, setValue] = useState(count)

  return (
    <div>
      <h1>{title}</h1>
      <button onClick={() => setValue(v => v + 1)}>{value}</button>
    </div>
  )
}
```

#### Vue

Vue 3对TypeScript有原生支持：

```bash
# 创建TypeScript版本的Vue应用
npm create vue@latest my-app
# 选择TypeScript选项
```

```typescript
import { defineComponent, ref } from 'vue'

export default defineComponent({
  props: {
    title: String,
    count: { type: Number, default: 0 }
  },
  setup(props) {
    const value = ref(props.count)

    const increment = () => {
      value.value++
    }

    return { value, increment }
  }
})
```

#### Node.js

Node.js的类型定义需要单独安装：

```bash
npm install --save-dev @types/node
```

```typescript
import fs from 'fs'
import path from 'path'

const readFile = (filePath: string): Promise<string> => {
  return new Promise((resolve, reject) => {
    fs.readFile(filePath, 'utf-8', (err, data) => {
      if (err) reject(err)
      else resolve(data)
    })
  })
}
```

### 渐进式引入TypeScript

对于现有JavaScript项目，可以逐步引入TypeScript：

1. **启用allowJs**：允许编译JavaScript文件
2. **配置checkJs**：对JS文件进行类型检查
3. **添加.d.ts文件**：为现有JS代码添加类型定义
4. **逐步迁移**：将文件从.js重命名为.ts

```json
{
  "compilerOptions": {
    "allowJs": true,
    "checkJs": false,
    "outDir": "./dist",
    "target": "es2015",
    "module": "commonjs"
  },
  "include": ["src/**/*"]
}
```

## TypeScript处理非JavaScript资源

在实际开发中，TypeScript项目通常需要处理HTML、CSS、图片等非JavaScript资源。TypeScript本身不处理这些资源，但可以通过配置和工具链来实现。

### 模块声明方式

#### 使用.d.ts声明文件

为非JavaScript资源创建类型声明：

```typescript
// src/types/assets.d.ts
declare module '*.css' {
  const content: { [className: string]: string }
  export default content
}

declare module '*.scss' {
  const content: { [className: string]: string }
  export default content
}

declare module '*.less' {
  const content: { [className: string]: string }
  export default content
}

declare module '*.svg' {
  const content: React.FC<React.SVGProps<SVGSVGElement>>
  export default content
}

declare module '*.png' {
  const content: string
  export default content
}

declare module '*.jpg' {
  const content: string
  export default content
}

declare module '*.html' {
  const content: string
  export default content
}
```

#### 使用ambient module声明

在tsconfig.json中配置类型声明文件：

```json
{
  "compilerOptions": {
    "typeRoots": ["./node_modules/@types", "./src/types"]
  },
  "include": ["src/**/*"]
}
```

### 构建工具集成

#### Webpack配置

```javascript
// webpack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        use: ['style-loader', 'css-loader']
      },
      {
        test: /\.scss$/,
        use: ['style-loader', 'css-loader', 'sass-loader']
      },
      {
        test: /\.(png|jpg|jpeg|gif|svg)$/,
        type: 'asset/resource'
      },
      {
        test: /\.html$/,
        type: 'asset/source'
      }
    ]
  }
}
```

#### Vite配置

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  css: {
    modules: {
      localsConvention: 'camelCase'
    }
  },
  assetsInclude: ['**/*.html']
})
```

### CSS Modules类型支持

CSS Modules是React项目中常用的样式方案，TypeScript需要特殊配置：

```typescript
// src/types/css-modules.d.ts
declare module '*.module.css' {
  const classes: { [key: string]: string }
  export default classes
}

declare module '*.module.scss' {
  const classes: { [key: string]: string }
  export default classes
}
```

使用示例：

```typescript
import styles from './Button.module.css'

const Button = () => {
  return <button className={styles.primary}>Click me</button>
}
```

### 全局样式导入

对于全局样式文件，可以使用特殊的导入语法：

```typescript
// 直接导入，不使用导入的值
import './global.css'
import './theme.scss'

// 或使用require
require('./normalize.css')
```

### SVG组件化

在React项目中，可以将SVG作为组件导入：

```typescript
// vite-plugin-svgr 或 @svgr/webpack 配置后
import Logo from './logo.svg'

const Header = () => {
  return <Logo width={100} height={50} />
}
```

## 其他重要内容

### 编译流程

TypeScript的编译流程包括：

1. **词法分析和语法分析**：将源代码转换为抽象语法树（AST）
2. **类型检查**：基于AST进行类型推断和检查
3. **代码转换**：将TypeScript代码转换为JavaScript代码
4. **代码生成**：输出目标版本的JavaScript代码和Source Map

```bash
# 编译单个文件
tsc app.ts

# 使用配置文件编译
tsc

# 监听模式，文件变化时自动编译
tsc --watch

# 只进行类型检查，不生成文件
tsc --noEmit
```

### 开发工具支持

#### VS Code

VS Code对TypeScript有原生支持：

- 智能代码提示和自动补全
- 实时类型检查和错误提示
- 重命名、提取函数等重构操作
- 跳转到定义、查找引用
- 类型悬停提示

推荐安装的扩展：
- TypeScript Importer：自动导入模块
- ESLint：代码质量检查
- Prettier：代码格式化

#### 其他编辑器

- WebStorm：内置TypeScript支持
- Sublime Text：通过插件支持
- Vim/Neovim：通过coc.nvim或nvim-lspconfig支持

### 类型检查策略

根据项目需求选择合适的类型检查策略：

```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "strictBindCallApply": true,
    "strictPropertyInitialization": true,
    "noImplicitThis": true,
    "alwaysStrict": true
  }
}
```

对于新项目，建议启用strict模式；对于现有项目，可以逐步启用这些选项。

### 调试

TypeScript支持Source Map，可以直接调试TypeScript源码：

```json
{
  "compilerOptions": {
    "sourceMap": true,
    "inlineSourceMap": false,
    "inlineSources": false
  }
}
```

在Chrome DevTools或VS Code中设置断点，即可在TypeScript源码中调试。

## 总结

TypeScript通过类型系统为JavaScript带来了静态类型检查的能力，大大提升了大型项目的可维护性和开发效率。它与JavaScript生态无缝集成，支持渐进式引入，配合现代构建工具可以处理各种类型的资源。掌握TypeScript的核心概念和配置，能够帮助开发者构建更加健壮、可维护的前端应用。

下一步建议：
1. 深入学习类型系统（见"类型系统"章节）
2. 了解配置文件详细选项（见"tsconfig配置文件"章节）
3. 学习声明文件的编写（见"声明文件"章节）
4. 掌握高级类型和泛型（见"泛型"和"类型操作"章节）
